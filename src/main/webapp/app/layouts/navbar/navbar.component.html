<nav class="rv-navbar glass-strong" [class.rv-navbar--scrolled]="scrolled">
  <div class="rv-navbar__inner">
    <!-- Logo -->
    <a class="rv-navbar__logo" routerLink="/" (click)="collapseNavbar()">
      <span class="rv-navbar__logo-icon">
        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="14" cy="14" r="14" fill="#f5a520" />
          <path d="M10 8v12M14 8v5a3 3 0 0 0 3 3v4" stroke="#000" stroke-width="2" stroke-linecap="round" />
        </svg>
      </span>
      <span class="rv-navbar__logo-text">EasyToEat</span>
    </a>

    <!-- Desktop navigation -->
    <ul class="rv-navbar__nav">
      <li>
        <a class="rv-navbar__link" routerLink="/restaurante" routerLinkActive="rv-navbar__link--active" (click)="collapseNavbar()"
          >Restaurante</a
        >
      </li>
      <li>
        <a class="rv-navbar__link" routerLink="/cum-functioneaza" routerLinkActive="rv-navbar__link--active" (click)="collapseNavbar()"
          >Cum funcționează</a
        >
      </li>
      <li>
        <a class="rv-navbar__link" routerLink="/pentru-afaceri" routerLinkActive="rv-navbar__link--active" (click)="collapseNavbar()"
          >Pentru afaceri</a
        >
      </li>
    </ul>

    <!-- Right actions -->
    <div class="rv-navbar__actions">
      @let accountRef = account();
      @if (accountRef !== null) {
        <!-- Logged-in user dropdown -->
        <div ngbDropdown display="dynamic" class="rv-user-dropdown">
          <button class="rv-navbar__user-btn" ngbDropdownToggle>
            @if (accountRef.imageUrl) {
              <img [src]="accountRef.imageUrl" class="rv-avatar" alt="Avatar" />
            } @else {
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="12" cy="8" r="4" />
                <path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" />
              </svg>
            }
          </button>
          <ul class="dropdown-menu dropdown-menu-end rv-dropdown" ngbDropdownMenu>
            <li class="rv-dropdown__header">{{ accountRef.login }}</li>
            <li><a class="dropdown-item rv-dropdown__item" routerLink="/profil" (click)="collapseNavbar()">Profilul meu</a></li>
            <li><a class="dropdown-item rv-dropdown__item" routerLink="/account/password" (click)="collapseNavbar()">Schimbă parola</a></li>
            @if (isAdmin()) {
              <li>
                <hr class="dropdown-divider" />
              </li>
              <li>
                <a class="dropdown-item rv-dropdown__item" routerLink="/admin/user-management" (click)="collapseNavbar()">Administrare</a>
              </li>
            }
            <li>
              <hr class="dropdown-divider" />
            </li>
            <li><button class="dropdown-item rv-dropdown__item" (click)="logout()">Ieși din cont</button></li>
          </ul>
        </div>
      } @else {
        <button class="rv-navbar__user-btn" (click)="login()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.8"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="8" r="4" />
            <path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" />
          </svg>
        </button>
      }

      <!-- Mobile hamburger -->
      <button class="rv-navbar__hamburger" (click)="toggleNavbar()" [attr.aria-expanded]="!isNavbarCollapsed()">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <div class="rv-navbar__mobile-menu" [class.rv-navbar__mobile-menu--open]="!isNavbarCollapsed()">
    <a class="rv-mobile-link" routerLink="/restaurante" (click)="collapseNavbar()">Restaurante</a>
    <a class="rv-mobile-link" routerLink="/cum-functioneaza" (click)="collapseNavbar()">Cum funcționează</a>
    <a class="rv-mobile-link" routerLink="/pentru-afaceri" (click)="collapseNavbar()">Pentru afaceri</a>
    @if (account() === null) {
      <a class="rv-mobile-link rv-mobile-link--cta" routerLink="/login" (click)="collapseNavbar()">Autentificare</a>
    }
  </div>
</nav>

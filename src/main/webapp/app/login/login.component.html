<div class="rv-auth-page">
  <!-- Background blobs -->
  <div class="rv-auth-blob rv-auth-blob--1"></div>
  <div class="rv-auth-blob rv-auth-blob--2"></div>

  <div class="rv-auth-card animate-fade-in">
    <!-- Back link -->
    <a class="rv-auth-back" routerLink="/">
      <svg
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M19 12H5M5 12l7 7M5 12l7-7" />
      </svg>
      Înapoi
    </a>

    <!-- Logo -->
    <a class="rv-auth-logo" routerLink="/">
      <svg class="rv-auth-logo__icon" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="14" cy="14" r="14" fill="#f5a520" />
        <path d="M10 8v12M14 8v5a3 3 0 0 0 3 3v4" stroke="#000" stroke-width="2" stroke-linecap="round" />
      </svg>
      <span class="rv-auth-logo__text">EasyToEat</span>
    </a>

    <!-- Card -->
    <div class="glass rv-auth-inner">
      <h1 class="rv-auth-title">
        @if (isLogin()) {
          Bine ai revenit!
        } @else {
          Creează cont
        }
      </h1>
      <p class="rv-auth-subtitle">
        @if (isLogin()) {
          Autentifică-te pentru a continua
        } @else {
          Înregistrează-te pentru a rezerva mese
        }
      </p>

      <!-- ── LOGIN FORM ────────────────────────────────────────── -->
      @if (isLogin()) {
        <form class="rv-auth-form" (ngSubmit)="login()" [formGroup]="loginForm">
          @if (authenticationError()) {
            <div class="rv-auth-alert rv-auth-alert--error">Utilizator sau parolă incorectă. Încearcă din nou.</div>
          }

          <div class="rv-form-group">
            <label for="username">Utilizator</label>
            <input
              #usernameRef
              class="rv-input"
              type="text"
              id="username"
              formControlName="username"
              placeholder="utilizatorul tău"
              autocomplete="username"
            />
          </div>

          <div class="rv-form-group">
            <label for="password">Parolă</label>
            <div class="rv-input-wrap">
              <input
                class="rv-input"
                [type]="showPassword() ? 'text' : 'password'"
                id="password"
                formControlName="password"
                placeholder="••••••••"
                autocomplete="current-password"
              />
              <button type="button" class="rv-input-eye" (click)="togglePassword()" tabindex="-1">
                @if (showPassword()) {
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"
                    />
                    <line x1="1" y1="1" x2="23" y2="23" />
                  </svg>
                } @else {
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                }
              </button>
            </div>
          </div>

          <div class="rv-remember">
            <input type="checkbox" id="rememberMe" formControlName="rememberMe" />
            <label for="rememberMe">Ține-mă minte</label>
          </div>

          <button type="submit" class="rv-auth-submit" [disabled]="loginForm.invalid">Autentificare</button>
        </form>

        <div class="rv-auth-links">
          <a class="rv-auth-forgot" routerLink="/account/reset/request">Ai uitat parola?</a>
          <button class="rv-auth-toggle" type="button" (click)="toggleMode()">Nu ai cont? <span>Înregistrează-te</span></button>
        </div>
      }

      <!-- ── REGISTER FORM ──────────────────────────────────────── -->
      @else {
        <form class="rv-auth-form" (ngSubmit)="register()" [formGroup]="registerForm">
          @if (registerSuccess()) {
            <div class="rv-auth-alert rv-auth-alert--success">Cont creat! Redirecționare spre autentificare…</div>
          }
          @if (errorUserExists()) {
            <div class="rv-auth-alert rv-auth-alert--error">Utilizatorul există deja. Alege alt nume de utilizator.</div>
          }
          @if (errorEmailExists()) {
            <div class="rv-auth-alert rv-auth-alert--error">Adresa de email este deja înregistrată.</div>
          }
          @if (doNotMatch()) {
            <div class="rv-auth-alert rv-auth-alert--error">Parolele nu se potrivesc.</div>
          }
          @if (errorRegister()) {
            <div class="rv-auth-alert rv-auth-alert--error">A apărut o eroare. Încearcă din nou.</div>
          }

          <div class="rv-form-group">
            <label for="reg-login">Utilizator</label>
            <input
              class="rv-input"
              type="text"
              id="reg-login"
              formControlName="login"
              placeholder="utilizatorul dorit"
              autocomplete="username"
            />
          </div>

          <div class="rv-form-group">
            <label for="reg-email">Email</label>
            <input
              class="rv-input"
              type="email"
              id="reg-email"
              formControlName="email"
              placeholder="email@exemplu.md"
              autocomplete="email"
            />
          </div>

          <div class="rv-form-group">
            <label for="reg-password">Parolă</label>
            <div class="rv-input-wrap">
              <input
                class="rv-input"
                [type]="showPassword() ? 'text' : 'password'"
                id="reg-password"
                formControlName="password"
                placeholder="••••••••"
                autocomplete="new-password"
              />
              <button type="button" class="rv-input-eye" (click)="togglePassword()" tabindex="-1">
                @if (showPassword()) {
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"
                    />
                    <line x1="1" y1="1" x2="23" y2="23" />
                  </svg>
                } @else {
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                }
              </button>
            </div>
          </div>

          <div class="rv-form-group">
            <label for="reg-confirm">Confirmă parola</label>
            <input
              class="rv-input"
              [type]="showPassword() ? 'text' : 'password'"
              id="reg-confirm"
              formControlName="confirmPassword"
              placeholder="••••••••"
              autocomplete="new-password"
            />
          </div>

          <button type="submit" class="rv-auth-submit" [disabled]="registerForm.invalid">Creează cont</button>
        </form>

        <div class="rv-auth-links">
          <button class="rv-auth-toggle" type="button" (click)="toggleMode()">Ai deja cont? <span>Autentifică-te</span></button>
        </div>
      }
    </div>
  </div>
</div>
